<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Initialization</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; cursor: pointer; }
        .result { margin: 10px 0; padding: 10px; background: #f8f9fa; border-left: 4px solid #007bff; }
        .success { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; }
    </style>
</head>
<body>
    <h1>üêõ Debug Initialization</h1>
    
    <div class="debug-section">
        <h3>Step 1: Load Script</h3>
        <button onclick="loadScript()">Load main-enhanced.js</button>
        <div id="load-result" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>Step 2: Check Window Objects</h3>
        <button onclick="checkObjects()">Check Objects</button>
        <div id="objects-result" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>Step 3: Manual Initialization</h3>
        <button onclick="manualInit()">Manual Init</button>
        <div id="manual-result" class="result"></div>
    </div>
    
    <div class="debug-section">
        <h3>Step 4: Test generateTestData</h3>
        <button onclick="testGenerate()">Test Generate</button>
        <div id="generate-result" class="result"></div>
    </div>

    <script>
        function loadScript() {
            const result = document.getElementById('load-result');
            result.innerHTML = 'Loading script...';
            
            const script = document.createElement('script');
            script.src = 'main-enhanced.js';
            script.onload = () => {
                result.innerHTML = '‚úÖ Script loaded successfully!';
                result.className = 'result success';
                
                // Check if initialization function is available
                if (window.initializeEnhancedCorrelator) {
                    result.innerHTML += '<br>‚úÖ initializeEnhancedCorrelator function found!';
                } else {
                    result.innerHTML += '<br>‚ùå initializeEnhancedCorrelator function not found!';
                }
            };
            script.onerror = () => {
                result.innerHTML = '‚ùå Script failed to load!';
                result.className = 'result error';
            };
            document.head.appendChild(script);
        }
        
        function checkObjects() {
            const result = document.getElementById('objects-result');
            const objects = {
                'window.enhancedCorrelator': window.enhancedCorrelator,
                'window.initializeEnhancedCorrelator': window.initializeEnhancedCorrelator
            };
            
            let html = '<h4>Window Objects:</h4>';
            for (const [key, value] of Object.entries(objects)) {
                if (value) {
                    html += `<div style="color: #28a745;">‚úÖ ${key}: Found</div>`;
                    if (key === 'window.enhancedCorrelator') {
                        html += `<div style="margin-left: 20px;">Methods: ${Object.getOwnPropertyNames(value).join(', ')}</div>`;
                    }
                } else {
                    html += `<div style="color: #dc3545;">‚ùå ${key}: Not found</div>`;
                }
            }
            
            result.innerHTML = html;
            result.className = 'result';
        }
        
        function manualInit() {
            const result = document.getElementById('manual-result');
            
            if (window.initializeEnhancedCorrelator) {
                try {
                    window.initializeEnhancedCorrelator();
                    if (window.enhancedCorrelator) {
                        result.innerHTML = '‚úÖ Manual initialization successful!<br>Enhanced correlator created.';
                        result.className = 'result success';
                    } else {
                        result.innerHTML = '‚ùå Manual initialization failed - no correlator created.';
                        result.className = 'result error';
                    }
                } catch (error) {
                    result.innerHTML = '‚ùå Manual initialization error: ' + error.message;
                    result.className = 'result error';
                }
            } else {
                result.innerHTML = '‚ùå initializeEnhancedCorrelator function not available';
                result.className = 'result error';
            }
        }
        
        function testGenerate() {
            const result = document.getElementById('generate-result');
            
            if (window.enhancedCorrelator && window.enhancedCorrelator.generateTestData) {
                try {
                    window.enhancedCorrelator.generateTestData();
                    result.innerHTML = '‚úÖ generateTestData() called successfully!';
                    result.className = 'result success';
                } catch (error) {
                    result.innerHTML = '‚ùå generateTestData() failed: ' + error.message;
                    result.className = 'result error';
                }
            } else {
                result.innerHTML = '‚ùå generateTestData method not available';
                result.className = 'result error';
            }
        }
    </script>
</body>
</html>
